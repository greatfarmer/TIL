# if (kakao) dev 2018
![ifkakao2018](images/ifkakao2018.jpg)
- 주최: kakao
- 일시: 2018-09-04 (화) 10시 ~ 17시
- 장소: 삼성동 COEX 그랜드볼룸

## [!]공식 발표자료가 업로드되면 수정할 예정

## about
카카오가 하면 내 삶이 보다 좋게 바뀔거야.

일상의 불편을 해결하고, 때로는 예측할 수 없는 일을 벌이는 <br>
카카오에 대한 여러분의 기대는 우리의 자랑입니다. <br>
메신저부터 택시, 결제/송금에 은행까지 카카오 개발자에게 세상은 전부 개발거리입니다.

카카오의 미래 기술을 공유하고 나누는 if kakao 2018에 여러분을 초대합니다.

## 참가 대상
개발자 혹은 개발에 관심있는 누구나 (근데 추첨. 안누구나)

## 키노트
  - 카카오 Keyword
    - Stability
    - User Experience
    - Data
    - Next Innovation

  - 카카오 AI
    - kakao i
      - Home
        - GS건설
        - 포스코건설
      - Car
        - 현대자동차
      - kakao i developers
        - 2018.12 베타 오픈
    - open builder
      - 카카오톡 챗봇
        - 카카오 미니와 연동
    - 오픈 플랫폼화
      - Driving UX
      - Smart home
    - 개발자 커뮤니티 + 카카오
      - 사람
        - 개발자들이 모이는 장을 만드는 것
          - AI 컨퍼런스
          - CSI 워크샵
          - 봇 경진대회
          - Pay Talks
          - 블록체인 위크
          - TXGX
          - if kakao
          - 딥러닝 캠프
          - 카카오 아레나
          - 코드 페스티벌
        - kakao blind recruitment
          - 코딩테스트
          - 인터뷰
      - 기술
        - 기술 개방을 통한 기여
          - Open API
          - Platform
          - Tech Product
        - [kakao 기술블로그](tech.kakao.com)
      - 자원
        - 자원의 공유를 통한 커뮤니티 지원
          - 컨퍼런스, 세미나 후원
          - 밋업 @카카오오피스
          - AI 대학원 장학금

## 1. 맵매칭 (부정확한 GPS포인트들로부터 경로 추정하기)
### 연사 소개
(김상균(curt.k) 님)
- 카카오모빌리티
  - 카카오모빌리티에서 택시배차와 앱미터기 개발을 담당하고 있습니다.

### 발표 소개
맵매칭은 도로 네트워크에 차량의 위치 측정치를 매핑하여 정확한 모빌리티 사용자의 위치와 이동경로를 추정하는 과정으로, 내비게이션 길안내, 택시/대리 등의 이동경로 기반한 요금 산정, 교통흐름 분석, 이동 방향 결정 등에 활용된다.<br>
GPS 위치가 정확하고 업데이트 주기가 빠른 경우 GPS를 가까운 도로 네트워크 상에 매핑만 하면 되지만, 실 서비스에서는 실내, 도심, 터널 등의 환경에서 GPS 위치가 부정확하고, 수 십 초 이상 수신기 되지 않는 상황이 빈번하게 발생되어 확률 모델 적용이 필요하다.<br>
발표에서는 위 같은 상황에 대응 가능하도록 자체 개발된 Hidden Markov Model(HMM) 기반 맵매칭 알고리즘과 일평균 수백만 이동 경로에 적용된 서비스 시스템에 대해 설명하고, 실 데이터 처리 분석 결과를 공유한다.

```MapMatching``` ```GIS``` ```ITS``` ```HiddenMarkovModel```

### 발표 내용
- Java로 구현
- 맵 미터기
  - 카카오 블랙으로 시작
  - 톨비 자동계산
  - GPS + 맵매칭 + 도로 네트워크
- 맵 매칭
  - **정해진 경로없이 전체 네트워크를 대상으로 할 때**
  - 노드
  - 링크
  - 문제 발생
    - 이전 포인트와의 관계
  - Hidden Markov Model(HMM)
  - Emssion 확률
    - gps-candidate 거리에 따른 확률
  - Transition 확률
    - candidate 사이의 확률
  - 가장 높은 확률
  - vertex
  - viterbi
    - Dynamic Programming
    - 앞의 누적된 확률 참고
    - incremental viterbi
  - Prefilter
    - GPS 튀는 현상
      - 터널에서 많이 발생
    - 차량 진행방향의 좌우 GPS 오류
    - GPS 지그재그
      - 중복
        - 맵 매칭이후 중복제거
    - 맵 매칭 PIPE
      - Prefilter - MapMacher - Postfilter
    - 맵 매칭 구현
      - Kafka
    - 맵 매칭 활용
      - Raw GPS 경로
      - 현재위치 정확도 개선
        - 고가도로 위에 있는지 아래에 있는지
      - Navigation 속도 정확도 개선
        - 휴게소에 정차했을 경우

### 질문
  - 어떻게 신뢰?
    - threshhold
    - 알람
      - 눈으로
  - 거리 판단은 어떻게 하시는지?
    - 경험적
    - 논문 참고
  - 알고리즘 추리 (GPS 간격)은?
    - Interval
      - 몇 초 마다 GPS를 올려라
    - 도로가 복잡해진다면?
      - WPS
  - GPS가 아닌 모바일 네트워크 활용하는지?
    - 안드로이드 네트워크 값 그대로 사용
  - 데이터는 내부 vs 외부 어떻게 되는지?
    - 카카오 내부 데이터 사용
    - 공개되어 있지 않음
  - 좋은 GPS기술이 많은데 사용하지 않는 이유?
    - 초창기 맵미터기가 목표였기 때문
      - 거리, 시간 중요
  - GPS에서의 정확도 개선 여부?
    - 실외, 도로 가정
      - 등산 등 일상적인 용도가 아님
      - 차량을 위한 서비스
    - 핸드폰 기지국 이용 고려 중
    - 실내 사용도 향상도 고려 중
  - 개발단계에서부터 서비스단을 고려해서 설계하시는지?
    - 처음부터 서비스단 고려
    - 배터리 소모 부분까지 고려

## 2. 카카오뱅크 모바일앱 개발 이야기
### 연사 소개
(박이랑(bernard.park) 님)
- 카카오뱅크
  - 카카오모빌리티에서 택시배차와 앱미터기 개발을 담당하고 있습니다.

### 발표 소개
카카오뱅크의 모바일앱은 어떻게 개발되었는지 그 험난한 비하인드 스토리에 대해 얘기하고, 기존 은행에 대한 불편한 점들을 어떻게 카카오뱅크만의 차별점으로 만들었는지에 대해 말해봅니다. 또한 현재는 어떻게 은행 앱을 운영/개발하고 있는지 카카오뱅크만의 노하우를 공개합니다.

```UX``` ```Android``` ```iOS``` ```Swift``` ```카톡이체``` ```지문이체``` ```생체인증``` ```보안```

### 발표 내용
#### 일정 요약
- 2016.5.1 시작
- 2016.7.25 첫 프로토 타입 시연회
- 2016.11.8 2차 프로토 타입
- 2016.12.1 좌충우돌 험난한 시련
- 2017.1.16 은행업 본인가 심사
- 2017.4.5 본인가 승인
- 2017.5.25 클로즈 베타 오픈
- 2017.7.27 퍼블릭 오픈
- 2017.12.20 앱 안정화 집중
- 2018.9.3 지금은 열심히 영업 중

#### 본론
- 개발 문화
  - 동료 3명이 동의하지 않으면
    - merge하지 않음

### 질문
- 카카오 뱅크 API 언제 출시?
  - 고객, 안정화 진행 이후
  - 구체적인 계획은 밝히기 힘듦
- 카카오뱅크 UI테스트 툴?
  - 에스프레소
- iOS, Android UI 맞추는 방법? (UI협업 어떻게 하는지?)
  - 디자이너에게 iOS, Android 각각 따로 맞춤
    - 따로 따로
    - 별도의 툴 사용 X
- 아키텍쳐?
  - MVP
  - 클린 아키텍쳐
  - 코드량 최소화
- 오픈소스 검증 방법?
  - Star 수가 많은 것
  - 업데이트 활발한 것
- IMS, PSI 등 금융정부 요구사항 어떻게 대응?
  - 아직 경험 부족
  - 소극적인 대응 중

## 3. Unify data and model using Apache S2Graph and GraphQL
### 연사 소개
(윤도영(shon.0) 님)
- 카카오
  - 데이터와 데이터를 효율적으로 서비스에 적용하는 부분에 관심이 많은 개발자 입니다.

### 발표 소개
Graph Database인 Apache S2Graph(incubating)에서 GraphQL을 지원하는 방식에 대해 공유하고, 이를 활용하여 많은 서비스에 unified API를 제공한 방법을 공유하도록 하겠습니다. 또 단순한 API 뿐만이 아니라, machine learning을 통해 학습된 model을 data와 함께 어떻게 서비스에 seamless 하게 적용할 수 있는지 공유하도록 하겠습니다. 이번 발표에서는 앞의 기능에 대한 설명과 함께 실제로 카카오의 데이터에 어떻게 적용되어서 어떤 가치를 창출하고 있는지도 간략히 공유하도록 하겠습니다.

```Graph Database``` ```GraphQL``` ```빅데이터```

### 발표 내용
- 데이터와 모델의 통합
- Apache S2Graph
  - 많이 써주세요
- 메타 데이터: 누구/무엇
  - 사용자
  - 영화, 음악, 뉴스기사 ...
- 사용자 활동: 언제, 누가, 무엇에, 어떤 활동을 했다
  - 8월에 뚱이가 신과함께 영화를 봤다
- Graph
  - vertices
  - edges
- 데이터 표현
  - logical
  - physical
- Master Graph
- 많이 연동되는 서비스
  - API 갯수가 늘어나는 문제
  - 유지보수 힘듦
  - 데이터를 찾고 분석하는 것이 힘듦
  - 포맷이 제각각
  - 동일한 일이 계속 반복
- **사용자 기준으로 데이터를 잘 모아보자**
- 문제
  - 데이터
    - Propery Graph Model로 통합 관리
  - 모델
    - 여전히 통합 관리되지 않음
  - 모든 데이터를 가공 X
    - 비효율
    - DB -> 일반화된 Interface로 모델 기능
    - PostgreSQL
      - k-nearest neighbors algorithm (k-최근접 이웃 알고리즘)
- Master Graph + Model
- Action Type
- Master Graph -> ETL -> Sparse Matrix
  - Graph to Matrix
- 3가지
  - S2Graph Resolver
  - Model
  - Druid Resolver
- ROI
- HBase
  - HBase cluster
    - 카카오: 100 region server
      - Put: ~50k
      - Get: ~350k
- 실습
  - [movielens](https://github.com/apache/incubator-s2graph/tree/701f0eeac9acf3dac26be1a59831fbfb2f64020b/example/movielens)
- Technology Stack
  - S2Graph
  - HBase
  - Kafka
  - Spark
  - GraphQL
- Elasticsearch
- S2Graph 학습모델
  - immutable graph data로 추상화
- **모델링과 모델 서빙을 분리**

### 질문
- 기존 RDBMS구조 -> Graph구조 변환하는 과정?
  - DB Dump
  - Migration
  - 결국, 노가다
- 사용자가 비싼 쿼리를 남발한 적?
  - 있습니다
  - 방지하기 위해
    - Admin에서 관리
- Master Graph -> Matrix 변환 소요 시간?
  - 1~2시간 안에
  - batch 저장
    - timestamp 순으로
  - 결국
    - group by
  - 사실, 개인정보처리가 더 걸림
    - 2~3시간
  - 기존 데이터 + merge data 둘 다 사용

## 4. 카카오톡의 서버사이드 코틀린
### 연사 소개
(유용하(indy.jones) 님)
- 카카오
  - 카카오톡의 메시징 서버를 담당하고 있는 개발자입니다.

### 발표 소개
JVM 기반 언어의 코틀린은 자바의 생태계와 완전히 호환되면서도 간결하고 안전한 코드를 위한 문법을 가진 언어다. 이런 장점으로 최근 안드로이드를 중심으로 점차 자바를 대체해 가고 있지만, 아직 안정성과 성능에 보수적인 서버 분야에서 자바의 지위는 견고해 보인다. 하지만 기존의 자바 기반 프레임웍과도 완벽히 호환되는 코틀린은 서버사이드에서도 도입하지 않을 이유가 없으며 성공적인 도입 사례가 늘어날수록 그 추세는 가속화될 것이다. 현재 카카오톡의 일부 서버들도 코틀린으로 개발되어 대량의 요청을 안정적으로 서비스하고 있고 그 영역은 점점 늘어나고 있다. 이 세션에서는 다양한 서버 분야의 코틀린 도입에 도움이 될 만한 카카오톡 서버의 코틀린 적용 경험을 공유한다.

```카카오톡``` ```kotlin``` ```server```

### 발표 내용
- 겁나 빠른 황소 (LOCO) / 2011
- Brewery
  - 코틀린 (for JVM)
  - 카카오톡 서버 구조 개선 프로젝트
- 코틀린
  - Go, 엘릭서 X
  - 안정성
  - 검증된 자바의 생태계
  - 개발환경
  - 생태계
  - 문법
- 새로운 언어 도입 시 고려사항
  - 마이그레이션 비용
- Build Tool
  - Gradle
  - Maven(v3)
- 개발환경
  - IntelliJ IDEA
  - Eclipse
- 자바 to 코틀린
  - 복붙하면 자동변환 (클립보드)
- 100% 자바와 호환
  - 공식사이트에 나와 있음
- **기존 자바 프레임워크와 연동**
- 문법
  - 중복 최소화
  - 안전한 코드
    - Nullable 타입
    - 불변 컬렉션
    - final
      - **상속을 막는 것이 코드 안정서에 좋다**
  - 명확한 코드
    - 확장 함수
  - 간결함
    - 스마트 캐스트
  - 강력한 기능
    - 코루틴
- 자바와 코틀린 비교
  - RxJava2
  - Guice
  - gRPC-java
  - papi
  - Prometheus
  - ZooKeeper
  - vert.x
  - redis
  - consul
- 코틀린과 자바의 성능
  - 거의 같다
    - CPU성능
    - 응답시간
    - RSS Mem
- OpenJDK에서도 잘 돌아감
- 그래서
  - **코틀린 잘 돌아감**

### 질문
- 자바 -> 코틀린 어려웠던 점
  - immutable 개념
- 앞으로 Kotlin 활용?
  - Kotlin 서버 늘릴 예정
  - 서버개발자는 Kotlin 금방 배움
  - 자바로 작성한 코드가 잘 돌고 있다면
    - 굳이 코틀린으로 수정할 필요 없다
    - 새로운 코드를 코틀린으로 하는 것을 추천
- 스칼라, 코틀린 둘 중에 왜 코틀린?
  - 언어 싸움이 될 것 같아 조심스러움
  - **자바와의 호환성**
  - 컴파일 시간이 스칼라보다 빨라서

## 5. 스프링5 웹플럭스와 테스트 전략
### 연사 소개
(이일민(toby)) 님)
- Epril
  - 호주에 거주하고 있지만 여러 나라를 다니며 일하기 좋아하는 개발자. 오래전 스프링 프레임워크의 매력에 빠진 뒤로 스프링의 변화에 맞춰 기술을 공부하고 이를 이용해 일을 하는 것을 좋아한다. 최신 스프링에 추가된 함수형 반응형 프로그래밍 기술을 블록체인 코어 개발을 비롯한 여러 분야에 적용해보고 있다. 토비의 스프링이라는 책을 썼고, 유튜브에서 토비의 봄 TV라는 코딩 방송을 하기도 한다.

### 발표 소개
스프링5에 도입된 웹플럭스와 리액티브 함수형 프로그래밍 기술에 대한 여러가지 테스트 기술을 살펴보고 이를 효과적으로 개발에 적용하는 방법을 설명합니다.
- 리액티브 함수형 프로그래밍과 테스트
- 웹플럭스를 이용하는 웹 테스트
- 스프링5 애플리케이션의 테스트 전략

```Spring``` ```함수형 프로그래밍``` ```Reactive```

### 발표 내용
- 스프링 웹 플럭스 (리액티브)
  - Spring MVC를 다 드러내서 변경한 것
- 리액티브 스택, 서블릿 스택 공존
  - Spring.io 참고
- 스프링 웹 플럭스 도입 이유
  - 확장성
  - 고효율성
  - 본격적인 함수형 프로그래밍 모델 사용
- 스프링 웹 플럭스를 사용하지 않는게 좋은 이유
- 스프링 웹 플럭스는 Spring MVC로 시작해도 됨
  - **MVC에서 WebClient 사용이 가장 좋은 출발점**
- 리액티브 (함수형) 프로그래밍
- 비동기/논블록킹 API 호출
  - 가장 단순한 리액티브
  - CompletableFuture
    - ES6의 Promise와 비슷
  - Reactor Flux / Mono
    - 이것 쓰는 것을 추천
- 플럭스와 테스트
  - 테스트 코드는 동기 방식
    - 테스트 대상은 비동기
      - **StepVerifier**
    - 원격 리액티브 HTTP API 호출 테스트
      - WebClient
      - 러닝서버 통합테스트
      - 단위 테스트
      - 통합테스트 (feat. MockServer)
        - MockWebServer
- 웹 플럭스의 새로운 아키텍쳐
  - @EnableWebFlux
  - Functional Endpoint
    - Micro Web Framework
- TestWebClient
  - bindToRouter Function
    - 함수 단위 테스트
- 결론
  - 웹플럭스 써보세요!
  - 테스트 작성 많이 해보세요!

### 질문
- 스프링부트2 API 문서화 어떻게 하시는 지?
  - 기존 툴 사용 X
  - 수동으로, 코드로 문서제작
- 스프링5 관련 공부 어떻게?
  - 공식 레퍼런스 문서
  - 유튜브
  - 스프링 구현 소스에 있는 테스트코드 확인
  - **최대한 빨리 책쓰도록 하겠다**

## 후기
내가 너무 모르는게 많다<br>
토비님을 만나다<br>
좋은 자극을 많이 받았다
